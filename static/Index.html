<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>YouTube Direct Link — Simple Client</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;margin:0;background:#0f1720;color:#e6eef8;display:flex;align-items:center;justify-content:center;min-height:100vh}
    .card{width:720px;max-width:95%;background:#0b1220;padding:24px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,0.6)}
    h1{margin:0 0 12px;font-size:20px}
    label{display:block;font-size:13px;color:#9fb0d6;margin-top:8px}
    input[type=text]{width:100%;padding:10px;border-radius:8px;border:1px solid #203040;background:#071021;color:inherit}
    button{margin-top:12px;padding:10px 14px;border-radius:8px;border:0;background:#1e90ff;color:#042033;font-weight:600;cursor:pointer}
    pre{white-space:pre-wrap;background:#071827;padding:12px;border-radius:8px;overflow:auto}
    .row{display:flex;gap:8px}
    .col{flex:1}
    img.thumb{max-width:160px;border-radius:6px}
    .formats{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .fmt{background:#071b2a;padding:8px;border-radius:8px;border:1px solid #123246;min-width:140px}
    .muted{color:#86a0c6;font-size:13px}
    .error{color:#ff8b8b}
  </style>
</head>
<body>
  <main class="card">
    <h1>YouTube Direct Link — Simple Client</h1>
    <p class="muted">Enter a YouTube URL and the API will return direct video/audio links and basic info.</p><label for="api">API Base URL</label>
<input id="api" type="text" value="http://localhost:8080" />

<label for="url">YouTube URL</label>
<input id="url" type="text" placeholder="https://www.youtube.com/watch?v=..." />

<div class="row">
  <div class="col"><button id="submit">Get Info</button></div>
  <div class="col"><button id="clear">Clear</button></div>
</div>

<div id="status" class="muted" style="margin-top:10px"></div>

<div id="result" style="margin-top:12px"></div>

  </main>  <script>
    const submit = document.getElementById('submit');
    const clear = document.getElementById('clear');
    const urlInput = document.getElementById('url');
    const apiInput = document.getElementById('api');
    const status = document.getElementById('status');
    const result = document.getElementById('result');

    function setStatus(text, isError=false){
      status.textContent = text;
      status.className = isError ? 'error' : 'muted';
    }

    function clearResult(){
      result.innerHTML = '';
      setStatus('');
    }

    clear.addEventListener('click', ()=>{
      urlInput.value = '';
      clearResult();
    });

    submit.addEventListener('click', async ()=>{
      clearResult();
      const apiBase = apiInput.value.trim().replace(/\/+$/,'');
      const apiUrl = apiBase + '/info';
      const youtubeUrl = urlInput.value.trim();
      if(!youtubeUrl){ setStatus('Please enter a YouTube URL', true); return }

      setStatus('Fetching info...');

      try{
        const resp = await fetch(apiUrl, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({url: youtubeUrl})
        });

        if(!resp.ok){
          const err = await resp.json().catch(()=>({error:resp.statusText}));
          setStatus('Error: ' + (err.error||resp.statusText), true);
          return;
        }

        const data = await resp.json();
        renderResult(data);
        setStatus('Done');
      }catch(err){
        setStatus('Network error: '+err.message, true);
      }
    });

    function renderResult(data){
      const container = document.createElement('div');

      const header = document.createElement('div');
      header.style.display='flex';
      header.style.gap='12px';

      const thumb = document.createElement('img');
      thumb.className='thumb';
      thumb.src = data.thumbnail || '';
      thumb.alt = 'thumbnail';

      const meta = document.createElement('div');
      meta.innerHTML = `<strong>${escapeHtml(data.title || 'Untitled')}</strong><div class="muted">By ${escapeHtml(data.uploader||'Unknown')} • ${formatDuration(data.duration||0)}</div><div class="muted">Tags: ${(data.tags||[]).join(', ')}</div>`;

      header.appendChild(thumb);
      header.appendChild(meta);

      container.appendChild(header);

      // Description
      const desc = document.createElement('div');
      desc.style.marginTop='10px';
      desc.innerHTML = `<div class=\"muted\">Description</div><pre>${escapeHtml(data.description||'')}</pre>`;container.appendChild(desc);

  // Video formats
  const vf = document.createElement('div');
  vf.innerHTML = `<div class=\"muted\">Video formats (top)</div>`;
  const vfBox = document.createElement('div');
  vfBox.className='formats';

  const videos = (data.formats && data.formats.video) || [];
  if(videos.length===0){
    const p = document.createElement('div'); p.className='muted'; p.textContent='No progressive video formats found (may be DASH-only).'; vfBox.appendChild(p);
  }

  videos.forEach(v=>{
    const el = document.createElement('div'); el.className='fmt';
    el.innerHTML = `<div><strong>${v.quality}</strong> • ${v.fps}fps • ${v.tbr || 0}kbps</div><div class=\"muted\">${v.ext}</div><div style=\"margin-top:6px\"><a href=\"${v.url}\" target=\"_blank\" rel=\"noreferrer\">Open direct link</a></div>`;
    vfBox.appendChild(el);
  });

  vf.appendChild(vfBox);
  container.appendChild(vf);

  // Audio
  const af = document.createElement('div');
  af.style.marginTop='10px';
  af.innerHTML = `<div class=\"muted\">Best audio</div>`;
  if(data.formats && data.formats.audio){
    const a = data.formats.audio;
    const el = document.createElement('div'); el.className='fmt';
    el.innerHTML = `<div><strong>${a.format_id}</strong> • ${a.quality}</div><div class=\"muted\">${a.ext}</div><div style=\"margin-top:6px\"><a href=\"${a.url}\" target=\"_blank\" rel=\"noreferrer\">Open direct audio link</a></div>`;
    af.appendChild(el);
  }else{
    const p = document.createElement('div'); p.className='muted'; p.textContent='No audio-only formats found.'; af.appendChild(p);
  }

  container.appendChild(af);

  // Raw JSON toggle
  const rawBtn = document.createElement('button'); rawBtn.textContent='Show raw JSON'; rawBtn.style.marginTop='12px';
  const rawPre = document.createElement('pre'); rawPre.style.display='none'; rawPre.textContent = JSON.stringify(data, null, 2);
  rawBtn.addEventListener('click', ()=>{
    if(rawPre.style.display==='none'){ rawPre.style.display='block'; rawBtn.textContent='Hide raw JSON'}
    else { rawPre.style.display='none'; rawBtn.textContent='Show raw JSON'}
  });

  container.appendChild(rawBtn);
  container.appendChild(rawPre);

  result.appendChild(container);
}

function escapeHtml(s){
  if(!s) return '';
  return s.replace(/[&<>\"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;" })[c]);
}

function formatDuration(sec){
  sec = Number(sec)||0;
  const h = Math.floor(sec/3600); sec%=3600; const m = Math.floor(sec/60); const s = Math.floor(sec%60);
  return (h? h+':':'') + String(m).padStart(h?2:1,'0') + ':' + String(s).padStart(2,'0');
}

  </script>
</body>
</html>
